import { Component, Input } from '@angular/core';
import { ThWrapperBase } from './ThWrapperBase';
import * as i0 from "@angular/core";
// eslint-disable-next-line @angular-eslint/component-class-suffix
export class ThObjectBase extends ThWrapperBase {
    constructor(parent) {
        super();
        this.parent = parent;
    }
    addToParent() {
        if (this._objRef &&
            this.parent.objRef &&
            (!this._objRef.parent || this._objRef.parent.uuid !== this.parent.objRef.uuid)) {
            this.parent.objRef.add(this._objRef);
        }
    }
    removeFromParent() {
        this._objRef?.parent?.remove(this._objRef);
    }
    applyObjRef(objRef) {
        if (this._objRef !== objRef || this._objRef?.parent?.uuid !== this.parent.objRef.uuid) {
            this.removeFromParent();
            this._objRef = objRef;
            if (this.autoAddToParent) {
                this.addToParent();
            }
        }
        this.emitObjRefChange();
    }
    attachToParent(newRef, oldRef) {
        if (!this.parent.objRef || (newRef === oldRef && oldRef?.parent?.uuid === this.parent.objRef.uuid)) {
            return;
        }
        // remove old obj from parent
        if (oldRef && oldRef.parent) {
            oldRef.parent.remove(oldRef);
        }
        // add new obj to parent
        if (newRef && (!newRef.parent || (newRef.parent && newRef.parent.uuid !== this.parent.objRef.uuid))) {
            this.parent.objRef.add(newRef);
        }
    }
    // object 3d methods
    set lookAt(vector) {
        Promise.resolve().then(() => {
            // execute next microtick, to assume all
            // position changes already happend,
            // because lookAt triggers a world matrix calculation
            if (!this.objRef) {
                return;
            }
            if (Array.isArray(vector)) {
                this.objRef.lookAt(...vector);
            }
            else {
                this.objRef.lookAt(vector);
            }
        });
    }
}
ThObjectBase.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.1.1", ngImport: i0, type: ThObjectBase, deps: [{ token: ThObjectBase }], target: i0.ɵɵFactoryTarget.Component });
ThObjectBase.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.1.1", type: ThObjectBase, selector: "th-abs-object", inputs: { lookAt: "lookAt" }, usesInheritance: true, ngImport: i0, template: '<ng-content/>', isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.1.1", ngImport: i0, type: ThObjectBase, decorators: [{
            type: Component,
            args: [{
                    selector: 'th-abs-object',
                    template: '<ng-content/>'
                }]
        }], ctorParameters: function () { return [{ type: ThObjectBase }]; }, propDecorators: { lookAt: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGhPYmplY3RCYXNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXRocmVlL3NyYy9saWIvVGhPYmplY3RCYXNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBRXpELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQzs7QUFLaEQsa0VBQWtFO0FBQ2xFLE1BQU0sT0FBTyxZQUFpRCxTQUFRLGFBQXNCO0lBQzFGLFlBQW1CLE1BQXlCO1FBQzFDLEtBQUssRUFBRSxDQUFDO1FBRFMsV0FBTSxHQUFOLE1BQU0sQ0FBbUI7SUFFNUMsQ0FBQztJQUVlLFdBQVc7UUFDekIsSUFDRSxJQUFJLENBQUMsT0FBTztZQUNaLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTTtZQUNsQixDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUM5RTtZQUNBLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDdEM7SUFDSCxDQUFDO0lBRWUsZ0JBQWdCO1FBQzlCLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVrQixXQUFXLENBQUMsTUFBcUI7UUFDbEQsSUFBSSxJQUFJLENBQUMsT0FBTyxLQUFLLE1BQU0sSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxJQUFJLEtBQUssSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO1lBQ3JGLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1lBQ3hCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBQ3RCLElBQUksSUFBSSxDQUFDLGVBQWUsRUFBRTtnQkFDeEIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO2FBQ3BCO1NBQ0Y7UUFDRCxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUMxQixDQUFDO0lBRVMsY0FBYyxDQUFDLE1BQVUsRUFBRSxNQUFVO1FBQzdDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sSUFBSSxDQUFDLE1BQU0sS0FBSyxNQUFNLElBQUksTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEtBQUssSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDbEcsT0FBTztTQUNSO1FBRUQsNkJBQTZCO1FBQzdCLElBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLEVBQUU7WUFDM0IsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDOUI7UUFFRCx3QkFBd0I7UUFDeEIsSUFBSSxNQUFNLElBQUksQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUU7WUFDbkcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1NBQ2hDO0lBQ0gsQ0FBQztJQUVELG9CQUFvQjtJQUNwQixJQUNXLE1BQU0sQ0FBQyxNQUFtRDtRQUNuRSxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtZQUMxQix3Q0FBd0M7WUFDeEMsb0NBQW9DO1lBQ3BDLHFEQUFxRDtZQUNyRCxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDaEIsT0FBTzthQUNSO1lBQ0QsSUFBSSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUN6QixJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDO2FBQy9CO2lCQUFNO2dCQUNMLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2FBQzVCO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDOzt5R0E5RFUsWUFBWTs2RkFBWixZQUFZLDBHQUhiLGVBQWU7MkZBR2QsWUFBWTtrQkFMeEIsU0FBUzttQkFBQztvQkFDVCxRQUFRLEVBQUUsZUFBZTtvQkFDekIsUUFBUSxFQUFFLGVBQWU7aUJBQzFCO2dHQWtEWSxNQUFNO3NCQURoQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBPYmplY3QzRCwgVmVjdG9yMyB9IGZyb20gJ3RocmVlJztcbmltcG9ydCB7IFRoV3JhcHBlckJhc2UgfSBmcm9tICcuL1RoV3JhcHBlckJhc2UnO1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGgtYWJzLW9iamVjdCcsXG4gIHRlbXBsYXRlOiAnPG5nLWNvbnRlbnQvPidcbn0pXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L2NvbXBvbmVudC1jbGFzcy1zdWZmaXhcbmV4cG9ydCBjbGFzcyBUaE9iamVjdEJhc2U8VCBleHRlbmRzIE9iamVjdDNELCBBUkdTID0gdW5rbm93bj4gZXh0ZW5kcyBUaFdyYXBwZXJCYXNlPFQsIEFSR1M+IGltcGxlbWVudHMgT25Jbml0IHtcbiAgY29uc3RydWN0b3IocHVibGljIHBhcmVudDogVGhPYmplY3RCYXNlPGFueT4pIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgcHVibGljIG92ZXJyaWRlIGFkZFRvUGFyZW50KCkge1xuICAgIGlmIChcbiAgICAgIHRoaXMuX29ialJlZiAmJlxuICAgICAgdGhpcy5wYXJlbnQub2JqUmVmICYmXG4gICAgICAoIXRoaXMuX29ialJlZi5wYXJlbnQgfHwgdGhpcy5fb2JqUmVmLnBhcmVudC51dWlkICE9PSB0aGlzLnBhcmVudC5vYmpSZWYudXVpZClcbiAgICApIHtcbiAgICAgIHRoaXMucGFyZW50Lm9ialJlZi5hZGQodGhpcy5fb2JqUmVmKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgb3ZlcnJpZGUgcmVtb3ZlRnJvbVBhcmVudCgpIHtcbiAgICB0aGlzLl9vYmpSZWY/LnBhcmVudD8ucmVtb3ZlKHRoaXMuX29ialJlZik7XG4gIH1cblxuICBwcm90ZWN0ZWQgb3ZlcnJpZGUgYXBwbHlPYmpSZWYob2JqUmVmOiBUIHwgdW5kZWZpbmVkKSB7XG4gICAgaWYgKHRoaXMuX29ialJlZiAhPT0gb2JqUmVmIHx8IHRoaXMuX29ialJlZj8ucGFyZW50Py51dWlkICE9PSB0aGlzLnBhcmVudC5vYmpSZWYudXVpZCkge1xuICAgICAgdGhpcy5yZW1vdmVGcm9tUGFyZW50KCk7XG4gICAgICB0aGlzLl9vYmpSZWYgPSBvYmpSZWY7XG4gICAgICBpZiAodGhpcy5hdXRvQWRkVG9QYXJlbnQpIHtcbiAgICAgICAgdGhpcy5hZGRUb1BhcmVudCgpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmVtaXRPYmpSZWZDaGFuZ2UoKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhdHRhY2hUb1BhcmVudChuZXdSZWY/OiBULCBvbGRSZWY/OiBUKSB7XG4gICAgaWYgKCF0aGlzLnBhcmVudC5vYmpSZWYgfHwgKG5ld1JlZiA9PT0gb2xkUmVmICYmIG9sZFJlZj8ucGFyZW50Py51dWlkID09PSB0aGlzLnBhcmVudC5vYmpSZWYudXVpZCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyByZW1vdmUgb2xkIG9iaiBmcm9tIHBhcmVudFxuICAgIGlmIChvbGRSZWYgJiYgb2xkUmVmLnBhcmVudCkge1xuICAgICAgb2xkUmVmLnBhcmVudC5yZW1vdmUob2xkUmVmKTtcbiAgICB9XG5cbiAgICAvLyBhZGQgbmV3IG9iaiB0byBwYXJlbnRcbiAgICBpZiAobmV3UmVmICYmICghbmV3UmVmLnBhcmVudCB8fCAobmV3UmVmLnBhcmVudCAmJiBuZXdSZWYucGFyZW50LnV1aWQgIT09IHRoaXMucGFyZW50Lm9ialJlZi51dWlkKSkpIHtcbiAgICAgIHRoaXMucGFyZW50Lm9ialJlZi5hZGQobmV3UmVmKTtcbiAgICB9XG4gIH1cblxuICAvLyBvYmplY3QgM2QgbWV0aG9kc1xuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IGxvb2tBdCh2ZWN0b3I6IFZlY3RvcjMgfCBbeDogbnVtYmVyLCB5OiBudW1iZXIsIHo6IG51bWJlcl0pIHtcbiAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKCgpID0+IHtcbiAgICAgIC8vIGV4ZWN1dGUgbmV4dCBtaWNyb3RpY2ssIHRvIGFzc3VtZSBhbGxcbiAgICAgIC8vIHBvc2l0aW9uIGNoYW5nZXMgYWxyZWFkeSBoYXBwZW5kLFxuICAgICAgLy8gYmVjYXVzZSBsb29rQXQgdHJpZ2dlcnMgYSB3b3JsZCBtYXRyaXggY2FsY3VsYXRpb25cbiAgICAgIGlmICghdGhpcy5vYmpSZWYpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmVjdG9yKSkge1xuICAgICAgICB0aGlzLm9ialJlZi5sb29rQXQoLi4udmVjdG9yKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub2JqUmVmLmxvb2tBdCh2ZWN0b3IpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iXX0=